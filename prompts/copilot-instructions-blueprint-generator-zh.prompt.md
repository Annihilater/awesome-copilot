````markdown
---
description: "技术无关的蓝图生成器，用于创建全面的 copilot-instructions.md 文件，通过分析现有代码库模式并避免假设，引导 GitHub Copilot 生成与项目标准、架构模式和确切技术版本一致的代码。"
mode: "agent"
---

# Copilot 指令蓝图生成器

## 配置变量

${PROJECT_TYPE="自动检测|.NET|Java|JavaScript|TypeScript|React|Angular|Python|多个|其他"} <!-- 主要技术 -->
${ARCHITECTURE_STYLE="分层|微服务|单体|领域驱动|事件驱动|无服务器|混合"} <!-- 架构方法 -->
${CODE_QUALITY_FOCUS="可维护性|性能|安全性|可访问性|可测试性|全部"} <!-- 质量优先级 -->
${DOCUMENTATION_LEVEL="最少|标准|全面"} <!-- 文档要求 -->
${TESTING_REQUIREMENTS="单元|集成|端到端|TDD|BDD|全部"} <!-- 测试方法 -->
${VERSIONING="语义化|CalVer|自定义"} <!-- 版本控制方法 -->

## 生成的提示

"生成一个全面的 copilot-instructions.md 文件，该文件将引导 GitHub Copilot 生成与我们项目的标准、架构和技术版本一致的代码。指令必须严格基于我们代码库中的实际代码模式，并避免做出任何假设。请遵循以下方法：

### 1. 核心指令结构

```markdown
# GitHub Copilot 指令

## 优先指南

为该存储库生成代码时：

1. **版本兼容性**：始终检测并尊重本项目中使用的语言、框架和库的确切版本
2. **上下文文件**：优先考虑 .github/copilot 目录中定义的模式和标准
3. **代码库模式**：当上下文文件未提供具体指导时，扫描代码库以查找已建立的模式
4. **架构一致性**：保持我们的 ${ARCHITECTURE_STYLE} 架构风格和已建立的边界
5. **代码质量**：在所有生成的代码中优先考虑 ${CODE_QUALITY_FOCUS == "全部" ? "可维护性、性能、安全性、可访问性和可测试性" : CODE_QUALITY_FOCUS}

## 技术版本检测

在生成代码之前，扫描代码库以识别：

1. **语言版本**：检测正在使用的编程语言的确切版本

   - 检查项目文件、配置文件和包管理器
   - 查找特定于语言的版本指示符（例如 .NET 项目中的 <LangVersion>）
   - 切勿使用超出检测版本的语言功能

2. **框架版本**：识别所有框架的确切版本

   - 检查 package.json、.csproj、pom.xml、requirements.txt 等
   - 生成代码时尊重版本约束
   - 切勿建议在检测到的框架版本中不可用的功能

3. **库版本**：记下关键库和依赖项的确切版本
   - 生成与这些特定版本兼容的代码
   - 切勿使用在检测到的版本中不可用的 API 或功能

## 上下文文件

优先考虑 .github/copilot 目录中的以下文件（如果存在）：

- **architecture.md**：系统架构指南
- **tech-stack.md**：技术版本和框架详细信息
- **coding-standards.md**：代码风格和格式标准
- **folder-structure.md**：项目组织指南
- **exemplars.md**：要遵循的示例代码模式

## 代码库扫描指令

当上下文文件未提供具体指导时：

1. 识别与正在修改或创建的文件相似的文件
2. 分析以下模式：
   - 命名约定
   - 代码组织
   - 错误处理
   - 日志记录方法
   - 文档风格
   - 测试模式
3. 遵循代码库中找到的最一致的模式
4. 当存在冲突的模式时，优先考虑较新文件或测试覆盖率较高的文件中的模式
5. 切勿引入在现有代码库中未找到的模式

## 代码质量标准

${CODE_QUALITY_FOCUS.includes("可维护性") || CODE_QUALITY_FOCUS == "全部" ? `### 可维护性

- 编写具有清晰命名的自文档化代码
- 遵循代码库中明显的命名和组织约定
- 遵循已建立的模式以保持一致性
- 保持函数专注于单一职责
- 限制函数复杂度和长度以匹配现有模式` : ""}

${CODE_QUALITY_FOCUS.includes("性能") || CODE_QUALITY_FOCUS == "全部" ? `### 性能

- 遵循现有的内存和资源管理模式
- 匹配处理计算密集型操作的现有模式
- 遵循已建立的异步操作模式
- 与现有模式一致地应用缓存
- 根据代码库中明显的模式进行优化` : ""}

${CODE_QUALITY_FOCUS.includes("安全性") || CODE_QUALITY_FOCUS == "全部" ? `### 安全性

- 遵循现有的输入验证模式
- 应用代码库中使用的相同清理技术
- 使用与现有模式匹配的参数化查询
- 遵循已建立的身份验证和授权模式
  ` : ""}
```
````
