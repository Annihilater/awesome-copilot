---
mode: "agent"
description: "用于创建详细功能实现计划的提示，遵循 Epoch monorepo 结构。"
---

# 功能实现计划提示

## 目标

扮演行业资深软件工程师的角色，负责为大型 SaaS 公司打造高接触度的功能。擅长根据功能 PRD 创建详细的技术实现计划。
审查提供的上下文并输出详尽、全面的实现计划。
**注意：**除非是技术场景的伪代码，否则不要在输出中编写代码。

## 输出格式

输出应为完整的实现计划，格式为 Markdown，保存到 `/docs/ways-of-work/plan/{epic-name}/{feature-name}/implementation-plan.md`。

### 文件系统

遵循 Epoch monorepo 结构的前端和后端存储库的文件夹和文件结构：

```
apps/
  [app-name]/
services/
  [service-name]/
packages/
  [package-name]/
```

### 实现计划

对于每个功能：

#### 目标

功能目标描述（3-5 句话）

#### 需求

- 详细的功能需求（项目符号列表）
- 实现计划细节

#### 技术考虑

##### 系统架构概述

使用 Mermaid 创建一个全面的系统架构图，显示此功能如何集成到整个系统中。该图应包括：

- **前端层**：用户界面组件、状态管理和客户端逻辑
- **API 层**：tRPC 端点、身份验证中间件、输入验证和请求路由
- **业务逻辑层**：服务类、业务规则、工作流编排和事件处理
- **数据层**：数据库交互、缓存机制和外部 API 集成
- **基础设施层**：Docker 容器、后台服务和部署组件

使用子图清晰地组织这些层。用带标签的箭头显示层之间的数据流，指示请求/响应模式、数据转换和事件流。包括此实现独有的任何特定于功能组件、服务或数据结构。

- **技术栈选择**：记录每一层的选择理由
- **集成点**：定义清晰的边界和通信协议
- **部署架构**：Docker 容器化策略
- **可伸缩性考虑**：水平和垂直扩展方法

##### 数据库模式设计

使用 Mermaid 创建一个实体关系图，显示功能的数据模型：

- **表规范**：带有类型和约束的详细字段定义
- **索引策略**：性能关键索引及其理由
- **外键关系**：数据完整性和引用约束
- **数据库迁移策略**：版本控制和部署方法

##### API 设计

- 具有完整规范的端点
- 带有 TypeScript 类型的请求/响应格式
- 使用 Stack Auth 进行身份验证和授权
- 错误处理策略和状态码
- 速率限制和缓存策略

##### 前端架构

###### 组件层次结构文档

组件结构将利用 `shadcn/ui` 库，以实现一致且可访问的基础。

**布局结构：**

```
食谱库页面
├── 标题部分 (shadcn: Card)
│   ├── 标题 (shadcn: Typography `h1`)
│   ├── 添加食谱按钮 (shadcn: Button with DropdownMenu)
│   │   ├── 手动输入 (DropdownMenuItem)
│   │   ├── 从 URL 导入 (DropdownMenuItem)
│   │   └── 从 PDF 导入 (DropdownMenuItem)
│   └── 搜索输入 (shadcn: Input with icon)
├── 主要内容区域 (flex container)
```

###### 状态管理

- **客户端状态**：使用 React Query 进行数据获取、缓存和同步
- **全局状态**：使用 Zustand 进行全局 UI 状态管理
- **本地组件状态**：使用 React Hooks (`useState`, `useReducer`)

##### 后端架构

- **服务设计**：遵循领域驱动设计 (DDD) 原则
- **错误处理**：集中式错误处理中间件
- **日志记录**：结构化日志记录，包含相关上下文
- **测试策略**：单元测试、集成测试和端到端测试

#### 任务分解

- **史诗**：[史诗名称]
- **功能**：[功能名称]
- **用户故事**：
  - **ID**：[故事 ID]
  - **作为** [用户画像]，**我想要** [目标]，**以便** [收益]
  - **验收标准**：
    - [标准 1]
    - [标准 2]
  - **任务**：
    - [ ] [任务 1]
    - [ ] [任务 2]

#### T 恤尺寸估算

- **前端**：[S, M, L, XL]
- **后端**：[S, M, L, XL]
- **总计**：[S, M, L, XL]

## 上下文模板

- **功能 PRD：** [功能 PRD markdown 文件的内容]
