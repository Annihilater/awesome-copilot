---
description: 'ReactJS 开发标准和最佳实践'
applyTo: '**/*.jsx, **/*.tsx, **/*.js, **/*.ts, **/*.css, **/*.scss'
---

# ReactJS 开发指令

使用现代模式、hooks 和最佳实践构建高质量 ReactJS 应用程序的指令，遵循 https://react.dev 官方 React 文档。

## 项目背景
- 最新 React 版本（React 19+）
- TypeScript 用于类型安全（如适用）
- 函数组件和 hooks 作为默认选择
- 遵循 React 官方风格指南和最佳实践
- 使用现代构建工具（Vite、Create React App 或自定义 Webpack 配置）
- 实现适当的组件组合和可重用性模式

## 开发标准

### 架构
- 使用函数组件和 hooks 作为主要模式
- 实现组合优于继承的组件
- 按功能或域组织组件以实现可扩展性
- 清晰地分离展示组件和容器组件
- 使用自定义 hooks 实现可重用的状态逻辑
- 实现具有清晰数据流的适当组件层次结构

### TypeScript 集成
- 对属性、状态和组件定义使用 TypeScript 接口
- 为事件处理程序和 refs 定义适当的类型
- 在适当的地方实现泛型组件
- 在 `tsconfig.json` 中使用严格模式确保类型安全
- 利用 React 的内置类型（`React.FC`、`React.ComponentProps` 等）
- 为组件变体和状态创建联合类型

### 组件设计
- 遵循组件的单一职责原则
- 使用描述性和一致的命名约定
- 使用 TypeScript 或 PropTypes 实现适当的属性验证
- 设计可测试和可重用的组件
- 保持组件小巧并专注于单一关注点
- 使用组合模式（render props、children as functions）

### 状态管理
- 对本地组件状态使用 `useState`
- 对复杂状态逻辑实现 `useReducer`
- 利用 `useContext` 在组件树间共享状态
- 对复杂应用程序考虑外部状态管理（Redux Toolkit、Zustand）
- 实现适当的状态规范化和数据结构
- 对服务器状态管理使用 React Query 或 SWR

### Hooks 和 Effects
- 使用带有适当依赖数组的 `useEffect` 避免无限循环
- 在 effects 中实现清理函数以防止内存泄漏
- 在需要时使用 `useMemo` 和 `useCallback` 进行性能优化
- 为可重用的状态逻辑创建自定义 hooks
- 遵循 hooks 规则（仅在顶层调用）
- 使用 `useRef` 访问 DOM 元素和存储可变值

### 样式
- 使用 CSS Modules、Styled Components 或现代 CSS-in-JS 解决方案
- 使用移动优先方法实现响应式设计
- 遵循 BEM 方法论或类似的 CSS 类命名约定
- 使用 CSS 自定义属性（变量）进行主题化
- 实现一致的间距、排版和颜色系统
- 使用适当的 ARIA 属性和语义 HTML 确保可访问性

### 性能优化
- 在适当时使用 `React.memo` 进行组件记忆化
- 使用 `React.lazy` 和 `Suspense` 实现代码分割
- 通过 tree shaking 和动态导入优化包大小
- 明智地使用 `useMemo` 和 `useCallback` 防止不必要的重新渲染
- 对大列表实现虚拟滚动
- 使用 React DevTools 分析组件以识别性能瓶颈

### 数据获取
- 使用现代数据获取库（React Query、SWR、Apollo Client）
- 实现适当的加载、错误和成功状态
- 处理竞态条件和请求取消
- 使用乐观更新以获得更好的用户体验
- 实现适当的缓存策略
- 优雅地处理离线场景和网络错误

### 错误处理
- 为组件级错误处理实现 Error Boundaries
- 在数据获取中使用适当的错误状态
- 为错误场景实现后备 UI
- 为调试适当记录错误
- 在 effects 和事件处理程序中处理异步错误
- 为用户提供有意义的错误消息

### 表单和验证
- 对表单输入使用受控组件
- 使用 Formik、React Hook Form 等库实现适当的表单验证
- 适当处理表单提交和错误状态
- 为表单实现可访问性功能（标签、ARIA 属性）
- 使用防抖验证以获得更好的用户体验
- 处理文件上传和复杂表单场景

### 路由
- 使用 React Router 进行客户端路由
- 实现嵌套路由和路由保护
- 适当处理路由参数和查询字符串
- 为基于路由的代码分割实现懒加载
- 使用适当的导航模式和后退按钮处理
- 实现面包屑和导航状态管理

### 测试
- 使用 React Testing Library 为组件编写单元测试
- 测试组件行为，而非实现细节
- 使用 Jest 作为测试运行器和断言库
- 为复杂组件交互实现集成测试
- 适当模拟外部依赖项和 API 调用
- 测试可访问性功能和键盘导航

### 安全性
- 清理用户输入以防止 XSS 攻击
- 在渲染前验证和转义数据
- 对所有外部 API 调用使用 HTTPS
- 实现适当的身份验证和授权模式
- 避免在 localStorage 或 sessionStorage 中存储敏感数据
- 使用内容安全策略（CSP）头

### 可访问性
- 适当使用语义 HTML 元素
- 实现适当的 ARIA 属性和角色
- 确保所有交互元素的键盘导航工作
- 为图像提供替代文本，为图标提供描述性文本
- 实现适当的颜色对比比例
- 使用屏幕阅读器和可访问性工具进行测试

## 实现过程
1. 规划组件架构和数据流
2. 使用适当的文件夹组织建立项目结构
3. 定义 TypeScript 接口和类型
4. 使用适当的样式实现核心组件
5. 添加状态管理和数据获取逻辑
6. 实现路由和导航
7. 添加表单处理和验证
8. 实现错误处理和加载状态
9. 为组件和功能添加测试覆盖
10. 优化性能和包大小
11. 确保可访问性合规性
12. 添加文档和代码注释

## 其他指南
- 遵循 React 的命名约定（组件使用 PascalCase，函数使用 camelCase）
- 使用有意义的提交消息并保持干净的 git 历史
- 实现适当的代码分割和懒加载策略
- 使用 JSDoc 记录复杂组件和自定义 hooks
- 使用 ESLint 和 Prettier 实现一致的代码格式化
- 保持依赖项更新并审计安全漏洞
- 为不同部署阶段实现适当的环境配置
- 使用 React Developer Tools 进行调试和性能分析

## 常见模式
- 高阶组件（HOCs）用于横切关注点
- Render props 模式用于组件组合
- 复合组件用于相关功能
- Provider 模式用于基于 context 的状态共享
- 容器/展示组件分离
- 用于可重用逻辑提取的自定义 hooks